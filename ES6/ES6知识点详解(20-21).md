# ES6 çŸ¥è¯†ç‚¹è¯¦è§£ï¼ˆ20-21ï¼‰

è¿™ä»½æ–‡æ¡£ä¼šç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è®²è§£ ES5 ç»§æ‰¿å’Œ ES6 class ç±»è¿™ä¸¤ä¸ªé‡è¦çŸ¥è¯†ç‚¹ã€‚

---

## ğŸ“Œ 20. ES5 ç»§æ‰¿

### ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ

**ä¸€å¥è¯**ï¼šç»§æ‰¿å°±æ˜¯è®©ä¸€ä¸ª"å­ç±»"æ‹¥æœ‰"çˆ¶ç±»"çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼ŒåŒæ—¶è¿˜èƒ½æ·»åŠ è‡ªå·±ç‹¬æœ‰çš„å†…å®¹ã€‚

**ç”Ÿæ´»ä¸­çš„ä¾‹å­**ï¼š
- çˆ¶äº²ä¼šå¼€è½¦ã€ä¼šåšé¥­ â†’ å„¿å­**ç»§æ‰¿**äº†è¿™äº›æŠ€èƒ½ï¼ŒåŒæ—¶è¿˜ä¼šæ‰“æ¸¸æˆï¼ˆè‡ªå·±çš„æŠ€èƒ½ï¼‰
- åŠ¨ç‰©éƒ½ä¼šåƒã€ä¼šç¡ â†’ çŒ«**ç»§æ‰¿**äº†è¿™äº›èƒ½åŠ›ï¼ŒåŒæ—¶è¿˜ä¼šæŠ“è€é¼ ï¼ˆçŒ«ç‹¬æœ‰çš„æŠ€èƒ½ï¼‰

---

### å›é¡¾ï¼šæ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡

åœ¨è®²ç»§æ‰¿ä¹‹å‰ï¼Œå…ˆå›é¡¾ä¸€ä¸‹å¦‚ä½•ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼š

```javascript
// åˆ›å»ºæ„é€ å‡½æ•°
function Person(name, age) {
    // åˆå§‹åŒ–å±æ€§ï¼ˆä¸€èˆ¬å†™åœ¨æ„é€ å‡½æ•°ä¸­ï¼‰
    this.type = "äºº";
    // ä¿å­˜æ„é€ å‡½æ•°ä¼ é€’çš„å‚æ•°
    this.name = name;
    this.age = age;
}

// æ–¹æ³•ä¸€èˆ¬å†™åœ¨åŸå‹å¯¹è±¡ä¸­ï¼ˆæ‰€æœ‰å®ä¾‹å…±äº«ï¼‰
Person.prototype.say = function() {
    console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäºº`);
}

// é€šè¿‡ new å…³é”®å­—åˆ›å»ºå®ä¾‹å¯¹è±¡
let p1 = new Person("å¼ ä¸‰", 18);
console.log(p1.type);  // "äºº"
p1.say();              // æˆ‘æ˜¯å¼ ä¸‰ï¼Œæˆ‘ä»Šå¹´18å²ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäºº
```

**ä¸ºä»€ä¹ˆæ–¹æ³•å†™åœ¨åŸå‹ä¸Šï¼Ÿ**
- å†™åœ¨æ„é€ å‡½æ•°å†…ï¼šæ¯æ¬¡ `new` éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œæµªè´¹å†…å­˜
- å†™åœ¨åŸå‹ä¸Šï¼šæ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€ä¸ªæ–¹æ³•ï¼ŒèŠ‚çœå†…å­˜

---

### ES5 ç»§æ‰¿çš„å®ç°æ­¥éª¤

ES5 å®ç°ç»§æ‰¿æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦**ä¸¤æ­¥**ï¼š

#### ç¬¬ä¸€æ­¥ï¼šç»§æ‰¿å±æ€§ï¼ˆä½¿ç”¨ `call`ï¼‰

```javascript
function Student(name, age, school) {
    // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œç»§æ‰¿å±æ€§
    Person.call(this, name, age);
    // åˆå§‹åŒ–å­ç±»è‡ªå·±çš„å±æ€§
    this.school = school;
}
```

**`Person.call(this, name, age)` æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ**

- `call` å¯ä»¥æ”¹å˜å‡½æ•°å†…éƒ¨çš„ `this` æŒ‡å‘
- è¿™é‡Œè®© `Person` å‡½æ•°å†…çš„ `this` æŒ‡å‘ `Student` çš„å®ä¾‹
- ç›¸å½“äºåœ¨ `Student` å†…éƒ¨æ‰§è¡Œäº† `Person` çš„ä»£ç ï¼ŒæŠŠå±æ€§å¤åˆ¶è¿‡æ¥

**å›¾è§£**ï¼š
```
Person.call(this, "æå››", 18)
    â†“ ç›¸å½“äºæ‰§è¡Œäº†
this.type = "äºº";
this.name = "æå››";
this.age = 18;
```

#### ç¬¬äºŒæ­¥ï¼šç»§æ‰¿æ–¹æ³•ï¼ˆä¿®æ”¹åŸå‹é“¾ï¼‰

```javascript
// è®© Student çš„åŸå‹æŒ‡å‘ Person çš„å®ä¾‹
Student.prototype = new Person();

// ä¿®å¤ constructor æŒ‡å‘é—®é¢˜
Student.prototype.constructor = Student;

// å­ç±»è‡ªå·±çš„æ–¹æ³•
Student.prototype.saySchool = function() {
    console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²ï¼Œæˆ‘å»${this.school}ä¸Šå­¦`);
}
```

**ä¸ºä»€ä¹ˆè¦ `Student.prototype = new Person()`ï¼Ÿ**

- è¿™æ · `Student` çš„åŸå‹å°±æ˜¯ `Person` çš„å®ä¾‹
- `Student` å®ä¾‹æŸ¥æ‰¾æ–¹æ³•æ—¶ï¼š`å®ä¾‹ â†’ Student.prototypeï¼ˆPersonå®ä¾‹ï¼‰â†’ Person.prototype`
- äºæ˜¯ `Student` å®ä¾‹å°±èƒ½è®¿é—®åˆ° `Person.prototype` ä¸Šçš„æ–¹æ³•äº†ï¼

**ä¸ºä»€ä¹ˆè¦ä¿®å¤ constructorï¼Ÿ**

```javascript
// åœ¨ä¿®æ”¹åŸå‹ä¹‹å
console.log(Student.prototype.constructor);  // Personï¼ˆæŒ‡å‘é”™è¯¯ï¼ï¼‰

// ä¿®å¤å
Student.prototype.constructor = Student;
console.log(Student.prototype.constructor);  // Studentï¼ˆæ­£ç¡®ï¼ï¼‰
```

---

### å®Œæ•´çš„ ES5 ç»§æ‰¿ä»£ç 

```javascript
// ========== çˆ¶ç±» ==========
function Person(name, age) {
    this.type = "äºº";
    this.name = name;
    this.age = age;
}
Person.prototype.say = function() {
    console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäºº`);
}

// ========== å­ç±» ==========
function Student(name, age, school) {
    // 1. ç»§æ‰¿å±æ€§
    Person.call(this, name, age);
    // 2. å­ç±»è‡ªå·±çš„å±æ€§
    this.school = school;
}

// 3. ç»§æ‰¿æ–¹æ³•
Student.prototype = new Person();
// 4. ä¿®å¤ constructor
Student.prototype.constructor = Student;
// 5. å­ç±»è‡ªå·±çš„æ–¹æ³•
Student.prototype.saySchool = function() {
    console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²ï¼Œæˆ‘å»${this.school}ä¸Šå­¦`);
}

// ========== æµ‹è¯• ==========
let s1 = new Student("æå››", 18, "æ¸…åå¤§å­¦");
s1.say();        // æˆ‘æ˜¯æå››ï¼Œæˆ‘ä»Šå¹´18å²ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäººï¼ˆç»§æ‰¿çš„æ–¹æ³•ï¼‰
s1.saySchool();  // æˆ‘æ˜¯æå››ï¼Œæˆ‘ä»Šå¹´18å²ï¼Œæˆ‘å»æ¸…åå¤§å­¦ä¸Šå­¦ï¼ˆè‡ªå·±çš„æ–¹æ³•ï¼‰
console.log(s1.constructor);  // Studentï¼ˆæ­£ç¡®ï¼‰
```

---

### ES5 ç»§æ‰¿å›¾è§£

```
Student å®ä¾‹ (s1)
    â”‚
    â”œâ”€â”€ type: "äºº"      â† ä» Person ç»§æ‰¿çš„å±æ€§
    â”œâ”€â”€ name: "æå››"    â† ä» Person ç»§æ‰¿çš„å±æ€§
    â”œâ”€â”€ age: 18         â† ä» Person ç»§æ‰¿çš„å±æ€§
    â”œâ”€â”€ school: "æ¸…å"  â† è‡ªå·±çš„å±æ€§
    â”‚
    â””â”€â”€ __proto__  â”€â”€â–¶  Student.prototype (= new Person())
                              â”‚
                              â””â”€â”€ __proto__  â”€â”€â–¶  Person.prototype
                                                      â”‚
                                                      â”œâ”€â”€ say()  â† ç»§æ‰¿çš„æ–¹æ³•
                                                      â”‚
                                                      â””â”€â”€ __proto__  â”€â”€â–¶  Object.prototype
```

---

### ğŸ¯ ES5 ç»§æ‰¿æ€»ç»“

| æ­¥éª¤ | ä»£ç  | ä½œç”¨ |
|:-----|:-----|:-----|
| ç»§æ‰¿å±æ€§ | `Parent.call(this, args)` | å¤åˆ¶çˆ¶ç±»çš„å±æ€§åˆ°å­ç±»å®ä¾‹ |
| ç»§æ‰¿æ–¹æ³• | `Child.prototype = new Parent()` | è®©å­ç±»èƒ½è®¿é—®çˆ¶ç±»åŸå‹çš„æ–¹æ³• |
| ä¿®å¤constructor | `Child.prototype.constructor = Child` | ä¿è¯ constructor æŒ‡å‘æ­£ç¡® |

**è®°å¿†å£è¯€**ï¼š
> call ç»§æ‰¿å±æ€§ï¼ŒåŸå‹ç»§æ‰¿æ–¹æ³•ï¼Œconstructor åˆ«å¿˜ä¿®ï¼

---

## ğŸ“Œ 21. ES6 Class ç±»

### ä¸ºä»€ä¹ˆéœ€è¦ classï¼Ÿ

ES5 çš„ç»§æ‰¿å†™æ³•å¤ªå¤æ‚äº†ï¼ES6 å¼•å…¥äº† `class` å…³é”®å­—ï¼Œè®©é¢å‘å¯¹è±¡ç¼–ç¨‹å˜å¾—**æ›´ç®€æ´ã€æ›´ç›´è§‚**ã€‚

**æœ¬è´¨**ï¼š`class` åªæ˜¯è¯­æ³•ç³–ï¼Œåº•å±‚è¿˜æ˜¯åŸºäºåŸå‹çš„ç»§æ‰¿ã€‚

---

### class çš„åŸºæœ¬è¯­æ³•

```javascript
// å®šä¹‰ä¸€ä¸ªç±»
class Person {
    // æ„é€ å‡½æ•°ï¼ˆåˆå§‹åŒ–å±æ€§ï¼‰
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    // æ–¹æ³•ï¼ˆè‡ªåŠ¨æ·»åŠ åˆ°åŸå‹ä¸Šï¼‰
    say() {
        console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²`);
    }
}

// åˆ›å»ºå®ä¾‹
let p1 = new Person("å¼ ä¸‰", 18);
p1.say();  // æˆ‘æ˜¯å¼ ä¸‰ï¼Œæˆ‘ä»Šå¹´18å²
```

**æ³¨æ„äº‹é¡¹**ï¼š
- `constructor` æ˜¯æ„é€ å‡½æ•°ï¼Œåˆ›å»ºå®ä¾‹æ—¶è‡ªåŠ¨è°ƒç”¨
- ç±»ä¸­çš„æ–¹æ³•**ä¸éœ€è¦å†™ `function` å…³é”®å­—**
- æ–¹æ³•ä¹‹é—´**ä¸éœ€è¦é€—å·**åˆ†éš”
- ç±»ä¸­çš„æ–¹æ³•ä¼šè‡ªåŠ¨æ·»åŠ åˆ° `prototype` ä¸Š

---

### class ç»§æ‰¿ï¼ˆä½¿ç”¨ extends å’Œ superï¼‰

```javascript
// å­ç±»ç»§æ‰¿çˆ¶ç±»
class Student extends Person {
    constructor(name, age, school) {
        // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼ˆå¿…é¡»åœ¨ä½¿ç”¨ this ä¹‹å‰ï¼‰
        super(name, age);
        // åˆå§‹åŒ–å­ç±»è‡ªå·±çš„å±æ€§
        this.school = school;
    }
    
    // å­ç±»è‡ªå·±çš„æ–¹æ³•
    saySchool() {
        console.log(`æˆ‘æ˜¯${this.name}ï¼Œæˆ‘ä»Šå¹´${this.age}å²ï¼Œæˆ‘å»${this.school}ä¸Šå­¦`);
    }
}

// åˆ›å»ºå®ä¾‹
let s1 = new Student("æå››", 18, "æ¸…åå¤§å­¦");
s1.say();        // æˆ‘æ˜¯æå››ï¼Œæˆ‘ä»Šå¹´18å²ï¼ˆç»§æ‰¿çš„æ–¹æ³•ï¼‰
s1.saySchool();  // æˆ‘æ˜¯æå››ï¼Œæˆ‘ä»Šå¹´18å²ï¼Œæˆ‘å»æ¸…åå¤§å­¦ä¸Šå­¦ï¼ˆè‡ªå·±çš„æ–¹æ³•ï¼‰
```

---

### å…³é”®å­—è§£é‡Š

#### `extends` - ç»§æ‰¿

```javascript
class Student extends Person { ... }
```
- è¡¨ç¤º `Student` ç»§æ‰¿è‡ª `Person`
- `Student` è‡ªåŠ¨æ‹¥æœ‰ `Person` çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•

#### `super` - è°ƒç”¨çˆ¶ç±»

```javascript
super(name, age);
```
- è°ƒç”¨çˆ¶ç±»çš„ `constructor`
- **å¿…é¡»åœ¨å­ç±» constructor ä¸­ä½¿ç”¨ `this` ä¹‹å‰è°ƒç”¨**
- ä¸è°ƒç”¨ `super` ä¼šæŠ¥é”™ï¼

**é”™è¯¯ç¤ºä¾‹**ï¼š
```javascript
class Student extends Person {
    constructor(name, age, school) {
        this.school = school;  // âŒ æŠ¥é”™ï¼å¿…é¡»å…ˆè°ƒç”¨ super
        super(name, age);
    }
}
```

**æ­£ç¡®å†™æ³•**ï¼š
```javascript
class Student extends Person {
    constructor(name, age, school) {
        super(name, age);      // âœ… å…ˆè°ƒç”¨ super
        this.school = school;  // âœ… å†ä½¿ç”¨ this
    }
}
```

---

### ES5 vs ES6 ç»§æ‰¿å¯¹æ¯”

| å¯¹æ¯”é¡¹ | ES5 å†™æ³• | ES6 å†™æ³• |
|:-------|:---------|:---------|
| å®šä¹‰ç±» | `function Person() {}` | `class Person {}` |
| å®šä¹‰æ–¹æ³• | `Person.prototype.say = function() {}` | ç›´æ¥åœ¨ class ä¸­å†™ `say() {}` |
| ç»§æ‰¿å±æ€§ | `Parent.call(this, args)` | `super(args)` |
| ç»§æ‰¿æ–¹æ³• | `Child.prototype = new Parent()` | `extends` è‡ªåŠ¨å¤„ç† |
| ä¿®å¤constructor | éœ€è¦æ‰‹åŠ¨ä¿®å¤ | è‡ªåŠ¨å¤„ç† |

**ä»£ç å¯¹æ¯”**ï¼š

```javascript
// ========== ES5 å†™æ³• ==========
function Person(name, age) {
    this.name = name;
    this.age = age;
}
Person.prototype.say = function() {
    console.log(`æˆ‘æ˜¯${this.name}`);
}

function Student(name, age, school) {
    Person.call(this, name, age);
    this.school = school;
}
Student.prototype = new Person();
Student.prototype.constructor = Student;
Student.prototype.saySchool = function() {
    console.log(`æˆ‘åœ¨${this.school}ä¸Šå­¦`);
}


// ========== ES6 å†™æ³• ==========
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    say() {
        console.log(`æˆ‘æ˜¯${this.name}`);
    }
}

class Student extends Person {
    constructor(name, age, school) {
        super(name, age);
        this.school = school;
    }
    saySchool() {
        console.log(`æˆ‘åœ¨${this.school}ä¸Šå­¦`);
    }
}
```

**ES6 çš„ä¼˜åŠ¿ä¸€ç›®äº†ç„¶**ï¼šä»£ç é‡æ›´å°‘ï¼Œé€»è¾‘æ›´æ¸…æ™°ï¼

---

### class çš„å…¶ä»–ç‰¹æ€§

#### 1. é™æ€æ–¹æ³•ï¼ˆstaticï¼‰

é™æ€æ–¹æ³•å±äºç±»æœ¬èº«ï¼Œä¸å±äºå®ä¾‹ã€‚

```javascript
class MathUtil {
    static add(a, b) {
        return a + b;
    }
}

// é€šè¿‡ç±»åç›´æ¥è°ƒç”¨
console.log(MathUtil.add(1, 2));  // 3

// å®ä¾‹æ— æ³•è°ƒç”¨é™æ€æ–¹æ³•
let m = new MathUtil();
m.add(1, 2);  // âŒ æŠ¥é”™ï¼
```

#### 2. getter å’Œ setter

```javascript
class Person {
    constructor(name) {
        this._name = name;
    }
    
    // getter
    get name() {
        return this._name;
    }
    
    // setter
    set name(value) {
        if (value.length < 2) {
            console.log("åå­—å¤ªçŸ­ï¼");
            return;
        }
        this._name = value;
    }
}

let p = new Person("å¼ ä¸‰");
console.log(p.name);  // å¼ ä¸‰ï¼ˆè°ƒç”¨ getterï¼‰
p.name = "æ";        // åå­—å¤ªçŸ­ï¼ï¼ˆè°ƒç”¨ setterï¼‰
p.name = "æå››";      // æˆåŠŸä¿®æ”¹
console.log(p.name);  // æå››
```

---

### ğŸ¯ ES6 Class æ€»ç»“

| è¯­æ³• | ä½œç”¨ | ç¤ºä¾‹ |
|:-----|:-----|:-----|
| `class` | å®šä¹‰ç±» | `class Person {}` |
| `constructor` | æ„é€ å‡½æ•° | `constructor(name) { this.name = name }` |
| `extends` | ç»§æ‰¿çˆ¶ç±» | `class Student extends Person` |
| `super` | è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° | `super(name, age)` |
| `static` | å®šä¹‰é™æ€æ–¹æ³• | `static add(a, b) {}` |

**è®°å¿†å£è¯€**ï¼š
> class å®šä¹‰ç±»ï¼Œconstructor åˆå§‹åŒ–ï¼Œextends æ¥ç»§æ‰¿ï¼Œsuper è°ƒçˆ¶ç±»ï¼

---

## ğŸ“Š ES5 ç»§æ‰¿ vs ES6 ç»§æ‰¿ å®Œæ•´å¯¹æ¯”

| ç‰¹ç‚¹ | ES5 ç»§æ‰¿ | ES6 ç»§æ‰¿ |
|:-----|:---------|:---------|
| è¯­æ³•å¤æ‚åº¦ | â­â­â­â­ å¤æ‚ | â­ ç®€å• |
| ä»£ç å¯è¯»æ€§ | â­â­ ä¸€èˆ¬ | â­â­â­â­â­ ä¼˜ç§€ |
| ç»§æ‰¿å±æ€§ | `Parent.call(this)` | `super()` |
| ç»§æ‰¿æ–¹æ³• | æ‰‹åŠ¨ä¿®æ”¹åŸå‹é“¾ | `extends` è‡ªåŠ¨å¤„ç† |
| åº•å±‚åŸç† | åŸå‹é“¾ | è¿˜æ˜¯åŸå‹é“¾ï¼ˆè¯­æ³•ç³–ï¼‰ |
| æµè§ˆå™¨æ”¯æŒ | æ‰€æœ‰æµè§ˆå™¨ | ç°ä»£æµè§ˆå™¨ |

---

## ğŸ¯ æœ€ç»ˆæ€»ç»“

### ES5 ç»§æ‰¿ä¸‰æ­¥èµ°ï¼š
1. **`Parent.call(this)`** - ç»§æ‰¿å±æ€§
2. **`Child.prototype = new Parent()`** - ç»§æ‰¿æ–¹æ³•
3. **`Child.prototype.constructor = Child`** - ä¿®å¤ constructor

### ES6 ç»§æ‰¿ä¸¤å…³é”®å­—ï¼š
1. **`extends`** - å£°æ˜ç»§æ‰¿å…³ç³»
2. **`super()`** - è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°

### é€‰æ‹©å»ºè®®ï¼š
- **æ–°é¡¹ç›®**ï¼šä¼˜å…ˆä½¿ç”¨ ES6 classï¼ˆä»£ç æ›´æ¸…æ™°ï¼‰
- **è€é¡¹ç›®/å…¼å®¹æ€§è¦æ±‚**ï¼šä½¿ç”¨ ES5 ç»§æ‰¿
- **é¢è¯•**ï¼šä¸¤ç§éƒ½è¦ä¼šï¼Œç†è§£åŸå‹é“¾åŸç†æœ€é‡è¦ï¼

---

*å¸Œæœ›è¿™ä»½è®²è§£èƒ½å¸®ä½ ç†è§£ ES5 ç»§æ‰¿å’Œ ES6 class ç±»ï¼æœ‰é—®é¢˜éšæ—¶é—®ï½* ğŸ˜Š
